// simplr v2.0.0
(function(d){Array.prototype.remove=function(a,c){var b=this.slice((c||a)+1||this.length);this.length=a<0?this.length+a:a;return this.push.apply(this,b)};window.Simplr={Config:{Data:{ConsoleActive:!1},mToggleConsole:function(a){d("#_simplr_core_console").remove();Simplr.Config.Data.ConsoleActive=!1;if(a)try{if(typeof window.console!="undefined"&&typeof window.console.group!="undefined")d(function(){d("body").append('<p id="_simplr_core_console" style="margin: 0; text-align: center; position: fixed; top: 0; width: 100%; left: 0; border-bottom: 1px solid #000; color: #fff; font-weight: bold; background-color: #f00; padding: 5px; font-size: 11px; opacity: .75;">[console]: Console Messaging Active</p>'); d("#_simplr_core_console").mouseover(function(){d(this).slideUp()}).mouseout(function(){d(this).delay(3E3).slideDown()})}),Simplr.Config.Data.ConsoleActive=!0}catch(c){}return Simplr.Config.Data.ConsoleActive}}};Simplr.Browser={};(function(){var a="";Simplr.Browser={mAddressBarHeight:function(){var a=Simplr.Browser.mDevice();return a=="iPhone"||a=="iPod"||a=="iPad"?60:0},mDevice:function(){if(a.match(/iPhone/i))return"iPhone";else if(a.match(/iPod/i))return"iPod";else if(a.match(/iPad/i))return"iPad"; else if(a.match(/Android/i))return"Android";return"other"},mLocalStorageCapable:function(){return Simplr.Core.Util.mHasLocalStorage()},mSetUserAgent:function(c){a=c},mTouchCapable:function(){var a=Simplr.Browser.mDevice();return a=="iPhone"||a=="iPod"||a=="iPad"||a=="Android"}};Simplr.Browser.mSetUserAgent(navigator.userAgent)})();Simplr.Cache={};(function(){Simplr.Cache={mExpire:function(a){Simplr.Core.Util.mHasLocalStorage()&&(localStorage.removeItem(a),localStorage.removeItem(a+"_data"));return null}, mGet:function(a){a=d.extend({key:"",identifier:""},a);if(Simplr.Core.Util.mHasLocalStorage()&&a.key!=""){var c=localStorage.getItem(a.key);if(c!=null&&(c=c.split("|"),c.length==2&&c[0]==a.identifier))if((new Date).getTime()<=parseInt(c[1],10))return localStorage.getItem(a.key+"_data");else Simplr.Cache.mExpire(a.key)}return null},mSet:function(a){a=d.extend({key:"",identifier:"",data:"",freshness:6E5},a);Simplr.Core.Util.mHasLocalStorage()&&a.key!=""&&(localStorage.setItem(a.key,a.identifier+"|"+ ((new Date).getTime()+a.freshness)),localStorage.setItem(a.key+"_data",a.data));return a.data}}})();Simplr.Controller={};(function(a,c,b){function f(a){a=a||location.href;return"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}var e="hashchange",g=document,d,j=a.event.special,i=g.documentMode,k="on"+e in c&&(i===b||i>7);a.fn[e]=function(a){return a?this.bind(e,a):this.trigger(e)};a.fn[e].delay=50;j[e]=a.extend(j[e],{setup:function(){if(k)return!1;a(d.start)},teardown:function(){if(k)return!1;a(d.stop)}});d=function(){function d(){var b= f(),g=m(j);if(b!==j)p(j=b,g),a(c).trigger(e);else if(g!==j)location.href=location.href.replace(/#.*/,"")+g;i=setTimeout(d,a.fn[e].delay)}var h={},i,j=f(),q=function(a){return a},p=q,m=q;h.start=function(){i||d()};h.stop=function(){i&&clearTimeout(i);i=b};a.browser.msie&&!k&&function(){var b,c;h.start=function(){if(!b)c=(c=a.fn[e].src)&&c+f(),b=a('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){c||p(f());d()}).attr("src",c||"javascript:0").insertAfter("body")[0].contentWindow, g.onpropertychange=function(){try{if(event.propertyName==="title")b.document.title=g.title}catch(a){}}};h.stop=q;m=function(){return f(b.location.href)};p=function(f,c){var d=b.document,h=a.fn[e].domain;if(f!==c)d.title=g.title,d.open(),h&&d.write('<script>document.domain="'+h+'"<\/script>'),d.close(),b.location.hash=f}}();return h}()})(jQuery,this);(function(){function a(a){return a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var c={CRUD:{view:!0,"new":!0,update:!0,"delete":!0}, Commands:{},Bases:{}};Simplr.Controller={mAddBases:function(a){for(var a=d.isArray(a)?a:[a],f=0,e=a.length;f<e;f++)c.Bases[a[f]]=1},mAddCommands:function(a){for(var f in a){var e=d.extend({route:[],callback:function(){}},a[f]),g=e.route.join("_");if(g!="")c.Commands[g]=e.callback}},mData:function(){return c},mExecute:function(a){var f=a.route.join("_");try{c.Commands[f](a)}catch(e){}},mRoute:function(b){b={route:[],url:b,base:"",resources:{},action:"",parameters:{}};if(b.url.charAt(0)=="#")b.url= b.url.substring(1);if(b.url.charAt(0)=="!")b.url=b.url.substring(1);var f=b.url.split("?");f[0]=decodeURI(f[0]);var e=f[0],g;for(g in c.Bases)if((f[0]=f[0].replace(g,""))!=e){b.base=g;b.route.push(g);break}f[0]=f[0].split("/");b.action=f[0][f[0].length-1];b.action=c.CRUD[b.action]?b.action:"view";g=!0;for(var e="",h=0,j=f[0].length-1;h<j;h++)f[0][h]!=""&&(g?(e=f[0][h],b.route.push(e),b.resources[e]=""):b.resources[e]=f[0][h],g=!g);if(f[1]){f=f[1].split("&");g=0;for(e=f.length;g<e;g++)h=f[g].split("="), b.parameters[h[0]]=d.trim(a(decodeURIComponent(h[1])))}b.route.push(b.action);return b},mRouteAndExecute:function(a){Simplr.Controller.mExecute(Simplr.Controller.mRoute(a))}};d(function(){d(window).hashchange(function(){window.location.hash!=""&&Simplr.Controller.mRouteAndExecute("#"+(window.location.href.split("#")[1]||""))})})})();Simplr.Conversion={};var n;n||(n={});(function(){function a(a){return a<10?"0"+a:a}function c(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var f=j[a]; return typeof f==="string"?f:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function b(a,f){var e,j,o,q,p=g,m,l=f[a];l&&typeof l==="object"&&typeof l.toJSON==="function"&&(l=l.toJSON(a));typeof i==="function"&&(l=i.call(f,a,l));switch(typeof l){case "string":return c(l);case "number":return isFinite(l)?String(l):"null";case "boolean":case "null":return String(l);case "object":if(!l)return"null";g+=d;m=[];if(Object.prototype.toString.apply(l)==="[object Array]"){q=l.length;for(e= 0;e<q;e+=1)m[e]=b(e,l)||"null";o=m.length===0?"[]":g?"[\n"+g+m.join(",\n"+g)+"\n"+p+"]":"["+m.join(",")+"]";g=p;return o}if(i&&typeof i==="object"){q=i.length;for(e=0;e<q;e+=1)typeof i[e]==="string"&&(j=i[e],(o=b(j,l))&&m.push(c(j)+(g?": ":":")+o))}else for(j in l)Object.prototype.hasOwnProperty.call(l,j)&&(o=b(j,l))&&m.push(c(j)+(g?": ":":")+o);o=m.length===0?"{}":g?"{\n"+g+m.join(",\n"+g)+"\n"+p+"}":"{"+m.join(",")+"}";g=p;return o}}if(typeof Date.prototype.toJSON!=="function")Date.prototype.toJSON= function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, g,d,j={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i;if(typeof n.stringify!=="function")n.stringify=function(a,f,e){var c;d=g="";if(typeof e==="number")for(c=0;c<e;c+=1)d+=" ";else typeof e==="string"&&(d=e);if((i=f)&&typeof f!=="function"&&(typeof f!=="object"||typeof f.length!=="number"))throw Error("JSON.stringify");return b("",{"":a})};if(typeof n.parse!=="function")n.parse=function(a,e){function b(a,f){var c,d,g=a[f];if(g&&typeof g==="object")for(c in g)Object.prototype.hasOwnProperty.call(g, c)&&(d=b(g,c),d!==void 0?g[c]=d:delete g[c]);return e.call(a,f,g)}var c,a=String(a);f.lastIndex=0;f.test(a)&&(a=a.replace(f,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return c=eval("("+a+")"),typeof e==="function"?b({"":c},""):c;throw new SyntaxError("JSON.parse");}})();Simplr.Conversion= {mObjectToJSONString:function(a,c,b){return n.stringify(a,c,b)},mJSONStringToObject:function(a,c){return n.parse(a,c)}};Simplr.Cookie={};Simplr.Cookie={mGet:function(a){a=d.extend({name:""},a);return document.cookie.length>0&&!Simplr.Core.Util.mEmpty(a.name)&&(a=document.cookie.match("(^|;) ?"+a.name+"=([^;]*)(;|$)"))?decodeURIComponent(a[2]):null},mSet:function(a){a=d.extend({name:"",value:"",expireDays:null,path:"/",domain:null,secure:!1},a);if(!Simplr.Core.Util.mEmpty(a.name)){var c=a.name+"="+ encodeURIComponent(a.value);if(!Simplr.Core.Util.mEmpty(a.expireDays)){var b=new Date;b.setTime(b.getTime()+a.expireDays*864E5);c+="; expires="+b.toUTCString()}c+=!Simplr.Core.Util.mEmpty(a.path)?"; path="+a.path:"";c+=!Simplr.Core.Util.mEmpty(a.domain)?"; domain="+a.domain:"";c+=a.secure?"; secure":"";document.cookie=c;return!0}return!1},mExpire:function(a){return Simplr.Cookie.mSet(d.extend({name:"",expireDays:-1},a))}};Simplr.Core={};(function(){function a(c){if(d.isArray(c.message)){console.group(c.group); for(var b=0,f=c.message.length;b<f;b++){var e=d.extend(Simplr.Core.Console.mGetMessageTemplate(),c.message[b]);a(e)}}else console.group(c.message),console.log(c.data);console.groupEnd()}Simplr.Core.Console={mGetMessageTemplate:function(){return{group:"",message:"",data:""}},mMessage:function(c){Simplr.Config.Data.ConsoleActive&&(c=d.extend(Simplr.Core.Console.mGetMessageTemplate(),c),a(c))}}})();(function(){function a(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g, "&quot;")}function c(a,e){if(typeof a==typeof e){if(typeof a=="object"){if(d.isArray(a)){if(a.length==e.length){for(var b=0,h=a.length;b<h;b++)if(!c(a[b],e[b]))return!1;return!0}}else{for(b in a)if(!c(a[b],e[b]))return!1;var j=h=0;for(b in a)h++;for(b in e)j++;return h==j}return!1}return a==e}return!1}var b=typeof localStorage=="undefined"?!1:!0;Simplr.Core.Util={mEmpty:function(a){var b=typeof a;return b!="undefined"&&a!=null?b=="object"?d.isArray(a)?a.length==0:d.isEmptyObject(a):d.trim(a)=="": !0},mEqual:function(a){if(!Simplr.Core.Util.mEmpty(a)&&d.isArray(a)){for(var b=!0,g=0,h=a.length;g<h;g++)c(a[0],a[g])||(b=!1,g=h);return b}return!0},mGetUrlParameter:function(b){var e=window.location.search;if(Simplr.Core.Util.mEmpty(e))return null;else{for(var c={},e=e.substring(1).split("&"),h=0,j=e.length;h<j;h++){var i=e[h].split("=");c[i[0]]=d.trim(a(decodeURIComponent(i[1])))}return Simplr.Core.Util.mEmpty(b)?c:(b=c[b],typeof b=="undefined"?null:b)}},mHasLocalStorage:function(){return b}}})(); (function(){var a={};Simplr.Core.Ui={mElementInfo:function(a){var a=d.extend({selector:"body"},a),b=d(a.selector).eq(0),a=[b.width(),b.height()],b=b.offset(),b=[b.left,b.top];return{offsets:b,dimensions:a}},mWindowInfo:function(){var a={offsets:[0,0],dimensions:[0,0]};if(typeof window.pageYOffset=="number")a.offsets=[window.pageXOffset,window.pageYOffset];else if(document.body&&(document.body.scrollLeft||document.body.scrollTop))a.offsets=[document.body.scrollLeft,document.body.scrollTop];else if(document.documentElement&& (document.documentElement.scrollLeft||document.documentElement.scrollTop))a.offsets=[document.documentElement.scrollLeft,document.documentElement.scrollTop];if(typeof window.innerWidth=="number")a.dimensions=[window.innerWidth,window.innerHeight];else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight))a.dimensions=[document.documentElement.clientWidth,document.documentElement.clientHeight];return a},Widget:{mGenerateWidgetID:function(){var c= Math.floor(Math.random()*1E7);return Simplr.Core.Util.mEmpty(a[c])?(a[c]=!0,c):Simplr.Core.Ui.Widget.mGenerateWidgetID()}}}})();(function(a){function c(a,b){var c=b,d;for(d in a)c=c.replace(RegExp("\\$\\["+d+"\\]","g"),escape(a[d]));return unescape(c)}var b={codes:{eEmpty:"$[label] is empty.",eMissingValidator:"Missing Validator"},codeResultsTemplate:{success:[],error:[]},defaultCodeMessage:"$[label] is UNDEFINED",ruleResultsTemplate:{valid:!0,successCodes:[],errorCodes:[]},validators:{missingvalidator:function(){return a.extend(!0, {},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:!1,errorCodes:["eMissingValidator"]})},notempty:function(b){var e=a.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate());if(typeof b!="undefined"&&b!=null)if(typeof b=="string")e.valid=a.trim(b)!="";else if(a.isArray(b))e.valid=b.length!=0;else if(typeof b=="object")e.valid=!a.isEmptyObject(b);e.valid||e.errorCodes.push("eEmpty");return e}},validationResultsTemplate:{data:"",valid:!0,codes:{}}};Simplr.Core.Validation={mAddCodes:function(f){a.extend(b.codes, f)},mAddValidators:function(f){a.extend(b.validators,f)},mData:function(){return b},mGetCodeMessage:function(a,e){return b.codes[a]!=void 0?c({label:e},b.codes[a]):c({label:a},b.defaultCodeMessage)},mGetRuleResultsTemplate:function(){return a.extend(!0,{},b.ruleResultsTemplate)},mValidate:function(f){var f=a.extend(!0,{},b.validationResultsTemplate,{data:a.extend(!0,{},f)}),e;for(e in f.data){var c=f.data[e];f.codes[e]=a.extend(!0,{},b.codeResultsTemplate);for(var d=0,j=c.rules.length;d<j;d++){var i= c.rules[d],k=a.extend(!0,{},b.ruleResultsTemplate),k=b.validators[i]?b.validators[i](c.value):b.validators.missingvalidator(c.value),i=e,r=f;r.codes[i].success=r.codes[i].success.concat(k.successCodes);r.codes[i].error=r.codes[i].error.concat(k.errorCodes);if(!k.valid)r.valid=!1}f.codes[e].error.length==0&&f.codes[e].success.length==0&&delete f.codes[e]}return f}}})(jQuery);Simplr.Core.Validation.mAddCodes({eMissingValidator:"Missing Validator",eAlphaNumeric:"$[label] is not alphanumeric.",eAmericanExpress:"$[label] is not a valid AMERICAN EXPRESS number.", eDinersClub:"$[label] is not a valid DINERS CLUB number.",eDiscover:"$[label] is not a valid DISCOVER number.",eEmail:"$[label] is not an email address.",eEqual:"$[label] does not match.",eMastercard:"$[label] is not a valid MASTERCARD number.",eEmpty:"$[label] is empty.",eNumber:"$[label] is not a number.",ePhoneNumber:"$[label] is not a valid Phone Number.",ePostalCode:"$[label] is not a Postal Code.",eVisa:"$[label] is not a valid VISA number."});Simplr.Core.Validation.mAddValidators({missingvalidator:function(){return d.extend(!0, {},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:!1,errorCodes:["eMissingValidator"]})},alphanumeric:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^\w*$/.test(a)});a.valid||a.errorCodes.push("eAlphaNumeric");return a},americanexpress:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^3(4|7)\d{2}-?\d{6}-?\d{5}$/.test(a)});a.valid||a.errorCodes.push("eAmericanExpress");return a},dinersclub:function(a){a=d.extend(!0, {},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^3[0,6,8]\d{12}$/.test(a)});a.valid||a.errorCodes.push("eDinersClub");return a},discover:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^6011-?\d{4}-?\d{4}-?\d{4}$/.test(a)});a.valid||a.errorCodes.push("eDiscover");return a},email:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(a)});a.valid||a.errorCodes.push("eEmail"); return a},equal:function(a){var c=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate());if(d.isArray(a))for(var b=0,f=a.length;b<f;b++)if(!Simplr.Core.Util.mEqual([a[0],a[b]]))c.valid=!1,b=f;c.valid||c.errorCodes.push("eEqual");return c},mastercard:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^5[1-5]\d{2}-?\d{4}-?\d{4}-?\d{4}$/.test(a)});a.valid||a.errorCodes.push("eMastercard");return a},notempty:function(a){var c=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate()); if(typeof a!="undefined"&&a!=null)if(typeof a=="string")c.valid=d.trim(a)!="";else if(d.isArray(a))c.valid=a.length!=0;else if(typeof a=="object")c.valid=!d.isEmptyObject(a);c.valid||c.errorCodes.push("eEmpty");return c},number:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:!isNaN(parseFloat(a))&&isFinite(a)});a.valid||a.errorCodes.push("eNumber");return a},phonenumber:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^\d{10}$/.test(a)}); a.valid||a.errorCodes.push("ePhoneNumber");return a},postalcode:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^\d{5}([\-]?\d{4})?$/.test(a)});a.valid||a.errorCodes.push("ePostalCode");return a},visa:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^4\d{3}-?\d{4}-?\d{4}-?\d{4}$/.test(a)});a.valid||a.errorCodes.push("eVisa");return a}});Simplr.Form={};(function(){var a,c,b,f;a={FormEntry:"formEntry",FormError:"formError",FieldError:"errorField", TextError:"errorText",TextInformation:"informationText"};b=["notempty"];f={};c={};Simplr.Form={mAddValidators:function(a){Simplr.Core.Validation.mAddValidators(a)},mGetValidators:function(){return Simplr.Core.Validation.mData().validators},mAddCodes:function(a){Simplr.Core.Validation.mAddCodes(a)},mGetCodes:function(){return Simplr.Core.Validation.mData().codes},mAddLabelAssociation:function(a){d.extend(c,a)},mAddValidationAssociation:function(a){d.extend(f,a)},mGetValues:function(a){var b={};d("input[type='checkbox']", a).each(function(){b[d(this).attr("name")]=d(this).is(":checked")?d(this).val()!="on"?d(this).val():!0:!1});d("input[type='text'], input[type='password'], input[type='hidden'], input[type='radio']:checked, select, textarea",a).each(function(){b[d(this).attr("name")]=d(this).val()});return b},mValidateValuesAndRender:function(e,g){var h={},j;for(j in g){for(var i={value:g[j],label:c[j]?c[j]:"_LABEL_",rules:[]},k=0,r=b.length;k<r;k++)i.rules.push(b[k]);try{f[j](i.rules)}catch(n){}h[j]=i}h=Simplr.Core.Validation.mValidate(h); d("."+a.FormError+",."+a.FieldError,e).filter("._simplr").removeClass(a.FormError).removeClass(a.FieldError);d("."+a.TextInformation+",."+a.TextError,e).filter("._simplr").remove();for(var s in h.codes){j=h.codes[s];j=[j.error,j.success];i="";for(k=0;k<2;k++)j[k].length>0&&(i+='<p class="'+(k==0?a.TextError:a.TextInformation)+' _simplr">'+Simplr.Core.Validation.mGetCodeMessage(j[k][0],h.data[s].label)+"</p>");d("[name='"+s+"']:first",e).addClass(a.FieldError+" _simplr").closest("."+a.FormEntry).addClass(a.FormError+ " _simplr").append(i)}return h.valid}}})();Simplr.Layout={};var t=function(a,c){typeof a=="string"&&(a=document.getElementById(a));if(a.nodeType!=1)return!1;var b=a.childNodes,f="";if(!c)for(var e=0;e<b.length;e++)if(b[e].nodeType==3){var d=b[e].nodeValue,d=d.replace(/</g,"&lt;"),d=d.replace(/>/g,"&gt;");f+=d}else if(b[e].nodeType==8)f+="<\!--"+b[e].nodeValue+"--\>";else{f+="<"+b[e].nodeName.toLowerCase();for(var d=b[e].attributes,h=0;h<d.length;h++){var j=d[h].nodeName.toLowerCase(),i=d[h].nodeValue; j=="style"&&b[e].style.cssText?f+=' style="'+b[e].style.cssText.toLowerCase()+'"':i&&j!="contenteditable"&&(f+=" "+j+'="'+i+'"')}f+=">"+t(b[e]);f+="</"+b[e].nodeName.toLowerCase()+">"}return f};(function(){function a(b){for(;d(".layout-component",b).size()>0;)a(d(".layout-component:eq(0)",b));var c={};c[b.attr("id").split("-")[1]]=t(b.get(0));Simplr.Layout.mAddComponents(c);b.remove()}var c={Components:{},GlobalTokens:{}};Simplr.Layout={mAddComponents:function(a){for(var f in a)c.Components[f]=d.trim(a[f].replace(/\n/g, "").replace(/\s{1,}/g," "))},mAddGlobalTokens:function(a){d.extend(c.GlobalTokens,a)},mAssembleLayout:function(a){var c="";if(a&&a.component&&a.tokens)for(var e=d.isArray(a.tokens)?a.tokens:[a.tokens],g=0,h=e.length;g<h;g++){var j={},i;for(i in e[g])j[i]=typeof e[g][i]=="object"?Simplr.Layout.mAssembleLayout(e[g][i]):e[g][i];c+=Simplr.Layout.mReplaceTokens(j,Simplr.Layout.mGetComponent(a.component))}return c},mData:function(){return c},mGetComponent:function(b){typeof c.Components[b]=="undefined"&& (d("#layout-"+b).size()>0?a(d("#layout-"+b)):c.Components[b]=null);return c.Components[b]},mReplaceTokens:function(a,f){if(f!=null){d.extend(a,c.GlobalTokens);for(var e in a)f=f.replace(RegExp("\\$\\["+e+"\\]","g"),escape(a[e]))}return unescape(f)}}})();Simplr.Trigger={};(function(){function a(a){var f={services:[],data:{envID:c.Env}};d.extend(!0,f,a.options);if(Simplr.Core.Util.mEmpty(f.services)){var e=[],g;for(g in c.Services)e.push(g);f.services=e}e=d.extend(Simplr.Core.Console.mGetMessageTemplate(), {group:"simplr.trigger: "+c.Env+" environment",message:[]});g=0;for(var h=f.services.length;g<h;g++){var j=f.services[g];d.isFunction(c.Services[j][a.type])&&c.Services[j].data.environmentIDs[c.Env]&&e.message.push({message:"["+j+"] "+a.type+" triggered.",data:c.Services[j][a.type](f.data)})}e.message.length>0&&Simplr.Core.Console.mMessage(e)}var c={Env:"_simplr",Services:{}};Simplr.Trigger={mAddServices:function(b){for(var f in b)c.Services[f]=d.extend({data:{environmentIDs:{}},onLoad:function(){}, onPage:function(){},onEvent:function(){},onTransaction:function(){}},b[f]),a({type:"onLoad",options:{services:[f]}})},mData:function(){return c},mSetEnvironment:function(a){c.Env=a},mOnPage:function(b){a({type:"onPage",options:d.extend({},b)})},mOnEvent:function(b){a({type:"onEvent",options:d.extend({},b)})},mOnTransaction:function(b){a({type:"onTransaction",options:d.extend({},b)})}}})();Simplr.Ui={Widget:{}};(function(){function a(a){var e=d("#"+a.id);e.size()==0?d("body").append('<div id="'+a.id+ '" style="position: absolute;"></div>'):(e.removeClass(c).removeClass(b),d(a.closeSelector).unbind("click.simplr.layer.destroy."+a.id));var e=d("#"+a.id),g=!(a.xPos!=null&&a.yPos!=null);g?(a.keepCentered&&e.addClass(b),Simplr.Ui.Layer.mCenter(a.id)):e.css("left",a.xPos+"px").css("top",a.yPos+"px");e.html(a.defaultContent);g&&Simplr.Ui.Layer.mCenter(a.id);d(a.closeSelector).bind("click.simplr.layer.destroy."+a.id,function(b){b.preventDefault();Simplr.Ui.Layer.mDestroy({id:a.id,closeSelector:a.closeSelector})})} var c="_simplr_centerLayer",b="_simplr_keepCenterLayer";Simplr.Ui.Layer={mCenter:function(a){if(!Simplr.Core.Util.mEmpty(a)){var a=d("#"+a),e=a.width(),g=a.height(),h=Simplr.Core.Ui.mWindowInfo(),j=0,j=(h.dimensions[0]-e)/2,j=j<0?20:j;j+=h.offsets[0];var i=0,i=(h.dimensions[1]-g)/2,i=i<0?20:i;i+=h.offsets[1];(e>h.dimensions[0]||g>h.dimensions[1])&&a.hasClass(b)&&a.removeClass(b).addClass(c);a.css("top",i+"px").css("left",j+"px")}},mCreate:function(b){var c=d.extend({ajax:null,callback:null,closeSelector:"#_simplr_layerClose", defaultContent:"",id:"_simplr_layer",isOverlay:!1,keepCentered:!1,xPos:null,yPos:null},b);if(c.isOverlay)c.id=c.id=="_simplr_layer"?"_simplr_overlay":c.id,c.closeSelector=c.closeSelector=="#_simplr_layerClose"?"#_simplr_overlayClose":c.closeSelector,c.xPos=0,c.yPos=0;a(c);if(c.ajax!=null){var g=c.ajax.success;c.ajax.success=function(b,f){c.defaultContent=b;a(c);d.isFunction(g)&&g(b,f)};d.ajax(c.ajax)}else d.isFunction(c.callback)&&c.callback();c.isOverlay&&d("#"+c.id).css({position:"fixed",width:"100%", height:"100%"})},mDestroy:function(a){a=d.extend({id:"_simplr_layer",closeSelector:"#_simplr_layerClose"},a);Simplr.Core.Util.mEmpty(a.id)||(d("#"+a.id).remove(),d(a.closeSelector).unbind("click.simplr.ui.layer.destroy."+a.id))}};d(function(){d(window).bind("resize.simplr.ui.layer",function(){d("."+b+",."+c).each(function(a,e){d(e).addClass(b).removeClass(c);Simplr.Ui.Layer.mCenter(d(e).attr("id"))})}).bind("scroll.simplr.ui.layer",function(){d("."+b).each(function(a,b){Simplr.Ui.Layer.mCenter(d(b).attr("id"))})})})})(); Simplr.Ui.mNewBrowserWindow=function(a){a=d.extend({url:"",width:500,height:500,name:"_simplr_newBrowserWindow"},a);if(!Simplr.Core.Util.mEmpty(a.url)){var c="width="+a.width+",height="+a.height,b=a.url,f=a.name;delete a.url;delete a.width;delete a.height;delete a.name;for(var e in a)c+=","+e+"="+a[e];e=window.open(b,f,c);e!=null&&e.focus()}};(function(){function a(a){this.data=d.extend({animateSpeed:200,containerSelector:"#_simplr_widget_trackableScrollingElement_container",elementSelector:"#_simplr_widget_trackableScrollingElement_element", offset:10,refreshSpeed:500,tolerance:10},a);this.data._PRIVATE={evtString:"scroll.simplr.widget.trackableScrollingElement."+Simplr.Core.Ui.Widget.mGenerateWidgetID(),timeout:null,previousOffset:0};this.destroy();var b=this;d(window).bind(b.data._PRIVATE.evtString,function(){clearTimeout(b.data._PRIVATE.timeout);b.data._PRIVATE.timeout=setTimeout(function(){var a=d(b.data.containerSelector).eq(0),c=a.children(b.data.elementSelector).eq(0);if(a.is(":visible")&&c.is(":visible")){var a=Simplr.Core.Ui.mElementInfo({selector:a}), g=Simplr.Core.Ui.mElementInfo({selector:c}),h=Simplr.Core.Ui.mWindowInfo(),j=h.offsets[1]-b.data._PRIVATE.previousOffset<0;b.data._PRIVATE.previousOffset=h.offsets[1];var i=null,k=[g.offsets[1]-b.data.tolerance,g.offsets[1]+b.data.tolerance],n=[g.offsets[1]+g.dimensions[1]-b.data.tolerance,g.offsets[1]+g.dimensions[1]+b.data.tolerance];h.dimensions[1]>g.dimensions[1]&&(h.offsets[1]<k[0]||h.offsets[1]>k[1])?i=h.offsets[1]-a.offsets[1]+b.data.offset:j&&h.offsets[1]<k[0]?i=h.offsets[1]-a.offsets[1]+ b.data.offset:h.offsets[1]+g.dimensions[1]>n[1]&&(i=h.offsets[1]-a.offsets[1]-(g.dimensions[1]-h.dimensions[1])-b.data.offset);i!=null&&(i<0?i=0:i>a.dimensions[1]-g.dimensions[1]&&(i=a.dimensions[1]-g.dimensions[1]),c.stop().animate({marginTop:i},b.data.animateSpeed))}else c.css("margin-top",0)},b.data.refreshSpeed)})}Simplr.Ui.Widget.oTrackableScrollingElement=function(c){return new a(c)};a.prototype.reset=function(){d(this.data.elementSelector).eq(0).css("margin-top",0)};a.prototype.destroy=function(){this.reset(); d(window).unbind(this.data._PRIVATE.evtString)}})();Simplr.Util={};Simplr.Util={mEmpty:function(a){return Simplr.Core.Util.mEmpty(a)},mEqual:function(a){return Simplr.Core.Util.mEqual(a)},mGetUrlParameter:function(a){return Simplr.Core.Util.mGetUrlParameter(a)},mHasLocalStorage:function(){return Simplr.Core.Util.mHasLocalStorage()},mTruncateString:function(a){a=d.extend({string:"",size:5,postfix:"",smart:!0},a);if(a.string.length>a.size){var c=a.size-a.postfix.length-1,b=c+1;if(a.smart)for(;a.string.charAt(c)!= " "&&c>0;)c--;return a.string.substring(0,c==0?b:c+1)+a.postfix}return a.string}};Simplr.Validation={};Simplr.Validation={mAddCodes:function(a){Simplr.Core.Validation.mAddCodes(a)},mGetCodes:function(){return Simplr.Core.Validation.mData().codes},mAddValidators:function(a){Simplr.Core.Validation.mAddValidators(a)},mGetValidators:function(){return Simplr.Core.Validation.mData().validators},mGetRuleResultsTemplate:function(){return Simplr.Core.Validation.mGetRuleResultsTemplate()},mGetCodeMessage:function(a, c){return Simplr.Core.Validation.mGetCodeMessage(a,c)},mValidate:function(a){return Simplr.Core.Validation.mValidate(a)}};Simplr.View={};(function(){var a={Views:{}};Simplr.View={mAddViews:function(c){for(var b in c){var f=d.extend(!0,{},{html:function(){return""},callback:function(){}},c[b]);a.Views[b]=f}},mData:function(){return a},mRender:function(c){c=d.extend({name:"",data:"",selector:""},c);d(c.selector).html(a.Views[c.name].html(c.data));a.Views[c.name].callback(c.selector,c.data)}}})()})(jQuery);