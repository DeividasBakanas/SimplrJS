// simplr v2.1.0
(function(d){Array.prototype.remove=function(a,b){var c=this.slice((b||a)+1||this.length);this.length=0>a?this.length+a:a;return this.push.apply(this,c)};window.Simplr={Config:{Data:{ConsoleActive:!1},mToggleConsole:function(a){d("#_simplr_core_console").remove();Simplr.Config.Data.ConsoleActive=!1;if(a)try{"undefined"!=typeof window.console&&"undefined"!=typeof window.console.group&&(d(function(){d("body").append('<p id="_simplr_core_console" style="margin: 0; text-align: center; position: fixed; top: 0; width: 100%; left: 0; border-bottom: 1px solid #000; color: #fff; font-weight: bold; background-color: #f00; padding: 5px; font-size: 11px; opacity: .75;">[console]: Console Messaging Active</p>'); d("#_simplr_core_console").mouseover(function(){d(this).slideUp()}).mouseout(function(){d(this).delay(3E3).slideDown()})}),Simplr.Config.Data.ConsoleActive=!0)}catch(b){}return Simplr.Config.Data.ConsoleActive}}};Simplr.Browser={};(function(){var a="";Simplr.Browser={mAddressBarHeight:function(){var a=Simplr.Browser.mDevice();return"iPhone"==a||"iPod"==a||"iPad"==a?60:0},mDevice:function(){return a.match(/iPhone/i)?"iPhone":a.match(/iPod/i)?"iPod":a.match(/iPad/i)?"iPad":a.match(/Android/i)?"Android": "other"},mLocalStorageCapable:function(){return Simplr.Core.Util.mHasLocalStorage()},mSetUserAgent:function(b){a=b},mTouchCapable:function(){var a=Simplr.Browser.mDevice();return"iPhone"==a||"iPod"==a||"iPad"==a||"Android"==a}};Simplr.Browser.mSetUserAgent(navigator.userAgent)})();Simplr.Cache={};(function(){Simplr.Cache={mExpire:function(a){Simplr.Core.Util.mHasLocalStorage()&&(localStorage.removeItem(a),localStorage.removeItem(a+"_data"));return null},mGet:function(a){a=d.extend({key:"",identifier:""}, a);if(Simplr.Core.Util.mHasLocalStorage()&&""!=a.key){var b=localStorage.getItem(a.key);if(null!=b&&(b=b.split("|"),2==b.length&&b[0]==a.identifier)){if((new Date).getTime()<=parseInt(b[1],10))return localStorage.getItem(a.key+"_data");Simplr.Cache.mExpire(a.key)}}return null},mSet:function(a){a=d.extend({key:"",identifier:"",data:"",freshness:6E5},a);Simplr.Core.Util.mHasLocalStorage()&&""!=a.key&&(localStorage.setItem(a.key,a.identifier+"|"+((new Date).getTime()+a.freshness)),localStorage.setItem(a.key+ "_data",a.data));return a.data}}})();Simplr.Controller={};(function(a,b,c){function e(a){a=a||location.href;return"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}var f="hashchange",g=document,d,j=a.event.special,i=g.documentMode,k="on"+f in b&&(i===c||7<i);a.fn[f]=function(a){return a?this.bind(f,a):this.trigger(f)};a.fn[f].delay=50;j[f]=a.extend(j[f],{setup:function(){if(k)return!1;a(d.start)},teardown:function(){if(k)return!1;a(d.stop)}});d=function(){function d(){var c=e(),g=n(j);c!==j?(p(j=c,g),a(b).trigger(f)): g!==j&&(location.href=location.href.replace(/#.*/,"")+g);i=setTimeout(d,a.fn[f].delay)}var h={},i,j=e(),q=function(a){return a},p=q,n=q;h.start=function(){i||d()};h.stop=function(){i&&clearTimeout(i);i=c};a.browser.msie&&!k&&function(){var c,b;h.start=function(){c||(b=(b=a.fn[f].src)&&b+e(),c=a('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){b||p(e());d()}).attr("src",b||"javascript:0").insertAfter("body")[0].contentWindow,g.onpropertychange=function(){try{"title"===event.propertyName&& (c.document.title=g.title)}catch(a){}})};h.stop=q;n=function(){return e(c.location.href)};p=function(e,b){var d=c.document,h=a.fn[f].domain;e!==b&&(d.title=g.title,d.open(),h&&d.write('<script>document.domain="'+h+'"<\/script>'),d.close(),c.location.hash=e)}}();return h}()})(jQuery,this);(function(){function a(a){return a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var b={CRUD:{view:!0,"new":!0,update:!0,"delete":!0},Commands:{},Bases:{}};Simplr.Controller={mAddBases:function(a){for(var a= d.isArray(a)?a:[a],e=0,f=a.length;e<f;e++)b.Bases[a[e]]=1},mAddCommands:function(a){for(var e in a){var f=d.extend({route:[],callback:function(){}},a[e]),g=f.route.join("_");""!=g&&(b.Commands[g]=f.callback)}},mData:function(){return b},mExecute:function(a){var e=a.route.join("_");if(d.isFunction(b.Commands[e]))b.Commands[e](a)},mRoute:function(c){c={route:[],url:c,base:"",resources:{},action:"",parameters:{}};"#"==c.url.charAt(0)&&(c.url=c.url.substring(1));"!"==c.url.charAt(0)&&(c.url=c.url.substring(1)); var e=c.url.split("?");e[0]=decodeURI(e[0]);var f=e[0],g;for(g in b.Bases)if((e[0]=e[0].replace(g,""))!=f){c.base=g;c.route.push(g);break}e[0]=e[0].split("/");c.action=e[0][e[0].length-1];c.action=b.CRUD[c.action]?c.action:"view";g=!0;for(var f="",h=0,j=e[0].length-1;h<j;h++)""!=e[0][h]&&(g?(f=e[0][h],c.route.push(f),c.resources[f]=""):c.resources[f]=e[0][h],g=!g);if(e[1]){e=e[1].split("&");g=0;for(f=e.length;g<f;g++)h=e[g].split("="),c.parameters[h[0]]=d.trim(a(decodeURIComponent(h[1])))}c.route.push(c.action); return c},mRouteAndExecute:function(a){Simplr.Controller.mExecute(Simplr.Controller.mRoute(a))}};d(function(){d(window).hashchange(function(){""!=window.location.hash&&Simplr.Controller.mRouteAndExecute("#"+(window.location.href.split("#")[1]||""))})})})();Simplr.Conversion={};var m;m||(m={});(function(){function a(a){return 10>a?"0"+a:a}function b(a){f.lastIndex=0;return f.test(a)?'"'+a.replace(f,function(a){var e=j[a];return"string"===typeof e?e:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+ '"':'"'+a+'"'}function c(a,e){var f,j,o,q,p=g,n,l=e[a];l&&"object"===typeof l&&"function"===typeof l.toJSON&&(l=l.toJSON(a));"function"===typeof i&&(l=i.call(e,a,l));switch(typeof l){case "string":return b(l);case "number":return isFinite(l)?""+l:"null";case "boolean":case "null":return""+l;case "object":if(!l)return"null";g+=d;n=[];if("[object Array]"===Object.prototype.toString.apply(l)){q=l.length;for(f=0;f<q;f+=1)n[f]=c(f,l)||"null";o=0===n.length?"[]":g?"[\n"+g+n.join(",\n"+g)+"\n"+p+"]":"["+ n.join(",")+"]";g=p;return o}if(i&&"object"===typeof i){q=i.length;for(f=0;f<q;f+=1)"string"===typeof i[f]&&(j=i[f],(o=c(j,l))&&n.push(b(j)+(g?": ":":")+o))}else for(j in l)Object.prototype.hasOwnProperty.call(l,j)&&(o=c(j,l))&&n.push(b(j)+(g?": ":":")+o);o=0===n.length?"{}":g?"{\n"+g+n.join(",\n"+g)+"\n"+p+"}":"{"+n.join(",")+"}";g=p;return o}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+ 1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,d,j={"\u0008":"\\b","\t":"\\t","\n":"\\n", "\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i;"function"!==typeof m.stringify&&(m.stringify=function(a,e,f){var b;d=g="";if("number"===typeof f)for(b=0;b<f;b+=1)d+=" ";else"string"===typeof f&&(d=f);if((i=e)&&"function"!==typeof e&&("object"!==typeof e||"number"!==typeof e.length))throw Error("JSON.stringify");return c("",{"":a})});"function"!==typeof m.parse&&(m.parse=function(a,f){function c(a,e){var b,d,g=a[e];if(g&&"object"===typeof g)for(b in g)Object.prototype.hasOwnProperty.call(g,b)&& (d=c(g,b),void 0!==d?g[b]=d:delete g[b]);return f.call(a,e,g)}var b,a=""+a;e.lastIndex=0;e.test(a)&&(a=a.replace(e,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return b=eval("("+a+")"),"function"===typeof f?c({"":b},""):b;throw new SyntaxError("JSON.parse");})})();Simplr.Conversion= {mObjectToJSONString:function(a,b,c){return m.stringify(a,b,c)},mJSONStringToObject:function(a,b){return m.parse(a,b)}};Simplr.Cookie={};Simplr.Cookie={mGet:function(a){a=d.extend({name:""},a);return 0<document.cookie.length&&!Simplr.Core.Util.mEmpty(a.name)&&(a=document.cookie.match("(^|;) ?"+a.name+"=([^;]*)(;|$)"))?decodeURIComponent(a[2]):null},mSet:function(a){a=d.extend({name:"",value:"",expireDays:null,path:"/",domain:null,secure:!1},a);if(!Simplr.Core.Util.mEmpty(a.name)){var b=a.name+"="+ encodeURIComponent(a.value);if(!Simplr.Core.Util.mEmpty(a.expireDays)){var c=new Date;c.setTime(c.getTime()+864E5*a.expireDays);b+="; expires="+c.toUTCString()}b+=!Simplr.Core.Util.mEmpty(a.path)?"; path="+a.path:"";b+=!Simplr.Core.Util.mEmpty(a.domain)?"; domain="+a.domain:"";b+=a.secure?"; secure":"";document.cookie=b;return!0}return!1},mExpire:function(a){return Simplr.Cookie.mSet(d.extend({name:"",expireDays:-1},a))}};Simplr.Core={};(function(){function a(b){if(d.isArray(b.message)){console.group(b.group); for(var c=0,e=b.message.length;c<e;c++){var f=d.extend(Simplr.Core.Console.mGetMessageTemplate(),b.message[c]);a(f)}}else console.group(b.message),console.log(b.data);console.groupEnd()}Simplr.Core.Console={mGetMessageTemplate:function(){return{group:"",message:"",data:""}},mMessage:function(b){Simplr.Config.Data.ConsoleActive&&(b=d.extend(Simplr.Core.Console.mGetMessageTemplate(),b),a(b))}}})();(function(){function a(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g, "&quot;")}function b(a,f){if(typeof a==typeof f){if("object"==typeof a){if(d.isArray(a)){if(a.length==f.length){for(var c=0,h=a.length;c<h;c++)if(!b(a[c],f[c]))return!1;return!0}}else{for(c in a)if(!b(a[c],f[c]))return!1;var j=h=0;for(c in a)h++;for(c in f)j++;return h==j}return!1}return a==f}return!1}var c="undefined"==typeof localStorage?!1:!0;Simplr.Core.Util={mEmpty:function(a){var c=typeof a;return"undefined"!=c&&null!=a?"object"==c?d.isArray(a)?0==a.length:d.isEmptyObject(a):""==d.trim(a):!0}, mEqual:function(a){if(!Simplr.Core.Util.mEmpty(a)&&d.isArray(a)){for(var c=!0,g=0,h=a.length;g<h;g++)b(a[0],a[g])||(c=!1,g=h);return c}return!0},mGetUrlParameter:function(e){var c=window.location.search;if(Simplr.Core.Util.mEmpty(c))return null;for(var b={},c=c.substring(1).split("&"),h=0,j=c.length;h<j;h++){var i=c[h].split("=");b[i[0]]=d.trim(a(decodeURIComponent(i[1])))}if(Simplr.Core.Util.mEmpty(e))return b;e=b[e];return"undefined"==typeof e?null:e},mHasLocalStorage:function(){return c}}})(); (function(){var a={};Simplr.Core.Ui={mElementInfo:function(a){var a=d.extend({selector:"body"},a),c=d(a.selector).eq(0),a=[c.width(),c.height()],c=c.offset(),c=[c.left,c.top];return{offsets:c,dimensions:a}},mWindowInfo:function(){var a={offsets:[0,0],dimensions:[0,0]};if("number"==typeof window.pageYOffset)a.offsets=[window.pageXOffset,window.pageYOffset];else if(document.body&&(document.body.scrollLeft||document.body.scrollTop))a.offsets=[document.body.scrollLeft,document.body.scrollTop];else if(document.documentElement&& (document.documentElement.scrollLeft||document.documentElement.scrollTop))a.offsets=[document.documentElement.scrollLeft,document.documentElement.scrollTop];if("number"==typeof window.innerWidth)a.dimensions=[window.innerWidth,window.innerHeight];else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight))a.dimensions=[document.documentElement.clientWidth,document.documentElement.clientHeight];return a},Widget:{mGenerateWidgetID:function(){var b= Math.floor(1E7*Math.random());return Simplr.Core.Util.mEmpty(a[b])?(a[b]=!0,b):Simplr.Core.Ui.Widget.mGenerateWidgetID()}}}})();(function(a){function b(a,c){var b=c,d;for(d in a)b=b.replace(RegExp("\\$\\["+d+"\\]","g"),escape(a[d]));return unescape(b)}var c={codes:{eEmpty:"$[label] is empty.",eMissingValidator:"Missing Validator"},codeResultsTemplate:{success:[],error:[]},defaultCodeMessage:"$[label] is UNDEFINED",ruleResultsTemplate:{valid:!0,successCodes:[],errorCodes:[]},validators:{missingvalidator:function(){return a.extend(!0, {},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:!1,errorCodes:["eMissingValidator"]})},notempty:function(c){var f=a.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate());"undefined"!=typeof c&&null!=c&&("string"==typeof c?f.valid=""!=a.trim(c):a.isArray(c)?f.valid=0!=c.length:"object"==typeof c&&(f.valid=!a.isEmptyObject(c)));f.valid||f.errorCodes.push("eEmpty");return f}},validationResultsTemplate:{data:"",valid:!0,codes:{}}};Simplr.Core.Validation={mAddCodes:function(e){a.extend(c.codes, e)},mAddValidators:function(e){a.extend(c.validators,e)},mData:function(){return c},mGetCodeMessage:function(a,f){return void 0!=c.codes[a]?b({label:f},c.codes[a]):b({label:a},c.defaultCodeMessage)},mGetRuleResultsTemplate:function(){return a.extend(!0,{},c.ruleResultsTemplate)},mValidate:function(e){var e=a.extend(!0,{},c.validationResultsTemplate,{data:a.extend(!0,{},e)}),f;for(f in e.data){var b=e.data[f];e.codes[f]=a.extend(!0,{},c.codeResultsTemplate);for(var d=0,j=b.rules.length;d<j;d++){var i= b.rules[d],k=a.extend(!0,{},c.ruleResultsTemplate),k=c.validators[i]?c.validators[i](b.value):c.validators.missingvalidator(b.value),i=f,r=e;r.codes[i].success=r.codes[i].success.concat(k.successCodes);r.codes[i].error=r.codes[i].error.concat(k.errorCodes);k.valid||(r.valid=!1)}0==e.codes[f].error.length&&0==e.codes[f].success.length&&delete e.codes[f]}return e}}})(jQuery);Simplr.Core.Validation.mAddCodes({eMissingValidator:"Missing Validator",eAlphaNumeric:"$[label] is not alphanumeric.",eAmericanExpress:"$[label] is not a valid AMERICAN EXPRESS number.", eDinersClub:"$[label] is not a valid DINERS CLUB number.",eDiscover:"$[label] is not a valid DISCOVER number.",eEmail:"$[label] is not an email address.",eEqual:"$[label] does not match.",eMastercard:"$[label] is not a valid MASTERCARD number.",eEmpty:"$[label] is empty.",eNumber:"$[label] is not a number.",ePhoneNumber:"$[label] is not a valid Phone Number.",ePostalCode:"$[label] is not a Postal Code.",eVisa:"$[label] is not a valid VISA number."});Simplr.Core.Validation.mAddValidators({missingvalidator:function(){return d.extend(!0, {},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:!1,errorCodes:["eMissingValidator"]})},alphanumeric:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^\w*$/.test(a)});a.valid||a.errorCodes.push("eAlphaNumeric");return a},americanexpress:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^3(4|7)\d{2}-?\d{6}-?\d{5}$/.test(a)});a.valid||a.errorCodes.push("eAmericanExpress");return a},dinersclub:function(a){a=d.extend(!0, {},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^3[0,6,8]\d{12}$/.test(a)});a.valid||a.errorCodes.push("eDinersClub");return a},discover:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^6011-?\d{4}-?\d{4}-?\d{4}$/.test(a)});a.valid||a.errorCodes.push("eDiscover");return a},email:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(a)});a.valid||a.errorCodes.push("eEmail"); return a},equal:function(a){var b=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate());if(d.isArray(a))for(var c=0,e=a.length;c<e;c++)Simplr.Core.Util.mEqual([a[0],a[c]])||(b.valid=!1,c=e);b.valid||b.errorCodes.push("eEqual");return b},mastercard:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^5[1-5]\d{2}-?\d{4}-?\d{4}-?\d{4}$/.test(a)});a.valid||a.errorCodes.push("eMastercard");return a},notempty:function(a){var b=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate()); "undefined"!=typeof a&&null!=a&&("string"==typeof a?b.valid=""!=d.trim(a):d.isArray(a)?b.valid=0!=a.length:"object"==typeof a&&(b.valid=!d.isEmptyObject(a)));b.valid||b.errorCodes.push("eEmpty");return b},number:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:!isNaN(parseFloat(a))&&isFinite(a)});a.valid||a.errorCodes.push("eNumber");return a},phonenumber:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^\d{10}$/.test(a)});a.valid|| a.errorCodes.push("ePhoneNumber");return a},postalcode:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^\d{5}([\-]?\d{4})?$/.test(a)});a.valid||a.errorCodes.push("ePostalCode");return a},visa:function(a){a=d.extend(!0,{},Simplr.Core.Validation.mGetRuleResultsTemplate(),{valid:/^4\d{3}-?\d{4}-?\d{4}-?\d{4}$/.test(a)});a.valid||a.errorCodes.push("eVisa");return a}});Simplr.Form={};(function(){var a,b,c,e;a={FormEntry:"formEntry",FormError:"formError",FieldError:"errorField", TextError:"errorText",TextInformation:"informationText"};c=["notempty"];e={};b={};Simplr.Form={mAddValidators:function(a){Simplr.Core.Validation.mAddValidators(a)},mGetValidators:function(){return Simplr.Core.Validation.mData().validators},mAddCodes:function(a){Simplr.Core.Validation.mAddCodes(a)},mGetCodes:function(){return Simplr.Core.Validation.mData().codes},mAddLabelAssociation:function(a){d.extend(b,a)},mAddValidationAssociation:function(a){d.extend(e,a)},mGetValues:function(a){var c={};d("input, select, textarea", a).each(function(){var a=d(this);if(!a.is("[type='button']")&&!a.is("[type='reset']")&&!(a.is("[type='submit']")||a.is("[type='radio']")&&!a.is(":checked")))a.is("[type='checkbox']")?c[d(this).attr("name")]=d(this).is(":checked")?"on"!=d(this).val()?d(this).val():!0:!1:c[d(this).attr("name")]=d(this).val()});return c},mValidateValuesAndRender:function(f,g){var h={},j;for(j in g){for(var i={value:g[j],label:b[j]?b[j]:"_LABEL_",rules:[]},k=0,r=c.length;k<r;k++)i.rules.push(c[k]);if(d.isFunction(e[j]))e[j](i.rules); h[j]=i}h=Simplr.Core.Validation.mValidate(h);d("."+a.FormError+",."+a.FieldError,f).filter("._simplr").removeClass(a.FormError).removeClass(a.FieldError);d("."+a.TextInformation+",."+a.TextError,f).filter("._simplr").remove();for(var m in h.codes){j=h.codes[m];j=[j.error,j.success];i="";for(k=0;2>k;k++)0<j[k].length&&(i+='<p class="'+(0==k?a.TextError:a.TextInformation)+' _simplr">'+Simplr.Core.Validation.mGetCodeMessage(j[k][0],h.data[m].label)+"</p>");d("[name='"+m+"']:first",f).addClass(a.FieldError+ " _simplr").closest("."+a.FormEntry).addClass(a.FormError+" _simplr").append(i)}return h.valid}}})();Simplr.Layout={};var s=function(a,b){"string"==typeof a&&(a=document.getElementById(a));if(1!=a.nodeType)return!1;var c=a.childNodes,e="";if(!b)for(var f=0;f<c.length;f++)if(3==c[f].nodeType)var d=c[f].nodeValue,d=d.replace(/</g,"&lt;"),d=d.replace(/>/g,"&gt;"),e=e+d;else if(8==c[f].nodeType)e+="<\!--"+c[f].nodeValue+"--\>";else{for(var e=e+("<"+c[f].nodeName.toLowerCase()),d=c[f].attributes,h=0;h< d.length;h++){var j=d[h].nodeName.toLowerCase(),i=d[h].nodeValue;"style"==j&&c[f].style.cssText?e+=' style="'+c[f].style.cssText.toLowerCase()+'"':i&&"contenteditable"!=j&&(e+=" "+j+'="'+i+'"')}e+=">"+s(c[f]);e+="</"+c[f].nodeName.toLowerCase()+">"}return e};(function(){function a(c){for(;0<d(".layout-component",c).size();)a(d(".layout-component:eq(0)",c));var e={};e[c.attr("id").split("-")[1]]=s(c.get(0));Simplr.Layout.mAddComponents(e);c.remove()}var b={Components:{},GlobalTokens:{}};Simplr.Layout= {mAddComponents:function(a){for(var e in a)b.Components[e]=d.trim(a[e].replace(/\n/g,"").replace(/\s{1,}/g," "))},mAddGlobalTokens:function(a){d.extend(b.GlobalTokens,a)},mAssembleLayout:function(a){var e="";if(a&&a.component&&a.tokens)for(var b=d.isArray(a.tokens)?a.tokens:[a.tokens],g=0,h=b.length;g<h;g++){var j={},i;for(i in b[g])j[i]="object"==typeof b[g][i]?Simplr.Layout.mAssembleLayout(b[g][i]):b[g][i];e+=Simplr.Layout.mReplaceTokens(j,Simplr.Layout.mGetComponent(a.component))}return e},mData:function(){return b}, mGetComponent:function(c){"undefined"==typeof b.Components[c]&&(0<d("#layout-"+c).size()?a(d("#layout-"+c)):b.Components[c]=null);return b.Components[c]},mReplaceTokens:function(a,e){if(null!=e){d.extend(a,b.GlobalTokens);for(var f in a)e=e.replace(RegExp("\\$\\["+f+"\\]","g"),escape(a[f]))}return unescape(e)}}})();Simplr.Trigger={};(function(){function a(a){var e={services:[],data:{envID:b.Env}};d.extend(!0,e,a.options);if(Simplr.Core.Util.mEmpty(e.services)){var f=[],g;for(g in b.Services)f.push(g); e.services=f}f=d.extend(Simplr.Core.Console.mGetMessageTemplate(),{group:"simplr.trigger: "+b.Env+" environment",message:[]});g=0;for(var h=e.services.length;g<h;g++){var j=e.services[g];d.isFunction(b.Services[j][a.type])&&b.Services[j].data.environmentIDs[b.Env]&&f.message.push({message:"["+j+"] "+a.type+" triggered.",data:b.Services[j][a.type](e.data)})}0<f.message.length&&Simplr.Core.Console.mMessage(f)}var b={Env:"_simplr",Services:{}};Simplr.Trigger={mAddServices:function(c){for(var e in c)b.Services[e]= d.extend({data:{environmentIDs:{}},onLoad:function(){},onPage:function(){},onEvent:function(){},onTransaction:function(){}},c[e]),a({type:"onLoad",options:{services:[e]}})},mData:function(){return b},mSetEnvironment:function(a){b.Env=a},mOnPage:function(c){a({type:"onPage",options:d.extend({},c)})},mOnEvent:function(c){a({type:"onEvent",options:d.extend({},c)})},mOnTransaction:function(c){a({type:"onTransaction",options:d.extend({},c)})}}})();Simplr.Ui={Widget:{}};(function(){function a(a){var f= d("#"+a.id);0==f.size()?d("body").append('<div id="'+a.id+'" style="position: absolute;"></div>'):(f.removeClass(b).removeClass(c),d(a.closeSelector).unbind("click.simplr.layer.destroy."+a.id));var f=d("#"+a.id),g=!(null!=a.xPos&&null!=a.yPos);g?(a.keepCentered&&f.addClass(c),Simplr.Ui.Layer.mCenter(a.id)):f.css("left",a.xPos+"px").css("top",a.yPos+"px");f.html(a.defaultContent);g&&Simplr.Ui.Layer.mCenter(a.id);d(a.closeSelector).bind("click.simplr.layer.destroy."+a.id,function(c){c.preventDefault(); Simplr.Ui.Layer.mDestroy({id:a.id,closeSelector:a.closeSelector})})}var b="_simplr_centerLayer",c="_simplr_keepCenterLayer";Simplr.Ui.Layer={mCenter:function(a){if(!Simplr.Core.Util.mEmpty(a)){var a=d("#"+a),f=a.width(),g=a.height(),h=Simplr.Core.Ui.mWindowInfo(),j=0,j=(h.dimensions[0]-f)/2,j=(0>j?20:j)+h.offsets[0],i=0,i=(h.dimensions[1]-g)/2,i=(0>i?20:i)+h.offsets[1];(f>h.dimensions[0]||g>h.dimensions[1])&&a.hasClass(c)&&a.removeClass(c).addClass(b);a.css("top",i+"px").css("left",j+"px")}},mCreate:function(c){var b= d.extend({ajax:null,callback:null,closeSelector:"#_simplr_layerClose",defaultContent:"",id:"_simplr_layer",isOverlay:!1,keepCentered:!1,xPos:null,yPos:null},c);b.isOverlay&&(b.id="_simplr_layer"==b.id?"_simplr_overlay":b.id,b.closeSelector="#_simplr_layerClose"==b.closeSelector?"#_simplr_overlayClose":b.closeSelector,b.xPos=0,b.yPos=0);a(b);if(null!=b.ajax){var g=b.ajax.success;b.ajax.success=function(c,e){b.defaultContent=c;a(b);d.isFunction(g)&&g(c,e)};d.ajax(b.ajax)}else d.isFunction(b.callback)&& b.callback();b.isOverlay&&d("#"+b.id).css({position:"fixed",width:"100%",height:"100%"})},mDestroy:function(a){a=d.extend({id:"_simplr_layer",closeSelector:"#_simplr_layerClose"},a);Simplr.Core.Util.mEmpty(a.id)||(d("#"+a.id).remove(),d(a.closeSelector).unbind("click.simplr.ui.layer.destroy."+a.id))}};d(function(){d(window).bind("resize.simplr.ui.layer",function(){d("."+c+",."+b).each(function(a,f){d(f).addClass(c).removeClass(b);Simplr.Ui.Layer.mCenter(d(f).attr("id"))})}).bind("scroll.simplr.ui.layer", function(){d("."+c).each(function(a,c){Simplr.Ui.Layer.mCenter(d(c).attr("id"))})})})})();Simplr.Ui.mNewBrowserWindow=function(a){a=d.extend({url:"",width:500,height:500,name:"_simplr_newBrowserWindow"},a);if(!Simplr.Core.Util.mEmpty(a.url)){var b="width="+a.width+",height="+a.height,c=a.url,e=a.name;delete a.url;delete a.width;delete a.height;delete a.name;for(var f in a)b+=","+f+"="+a[f];f=window.open(c,e,b);null!=f&&f.focus()}};(function(){function a(a){this.data=d.extend({animateSpeed:200,containerSelector:"#_simplr_widget_trackableScrollingElement_container", elementSelector:"#_simplr_widget_trackableScrollingElement_element",offset:10,refreshSpeed:500,tolerance:10},a);this.data._PRIVATE={evtString:"scroll.simplr.widget.trackableScrollingElement."+Simplr.Core.Ui.Widget.mGenerateWidgetID(),timeout:null,previousOffset:0};this.destroy();var c=this;d(window).bind(c.data._PRIVATE.evtString,function(){clearTimeout(c.data._PRIVATE.timeout);c.data._PRIVATE.timeout=setTimeout(function(){var a=d(c.data.containerSelector).eq(0),b=a.children(c.data.elementSelector).eq(0); if(a.is(":visible")&&b.is(":visible")){var a=Simplr.Core.Ui.mElementInfo({selector:a}),g=Simplr.Core.Ui.mElementInfo({selector:b}),h=Simplr.Core.Ui.mWindowInfo(),j=0>h.offsets[1]-c.data._PRIVATE.previousOffset;c.data._PRIVATE.previousOffset=h.offsets[1];var i=null,k=[g.offsets[1]-c.data.tolerance,g.offsets[1]+c.data.tolerance],m=[g.offsets[1]+g.dimensions[1]-c.data.tolerance,g.offsets[1]+g.dimensions[1]+c.data.tolerance];h.dimensions[1]>g.dimensions[1]&&(h.offsets[1]<k[0]||h.offsets[1]>k[1])?i=h.offsets[1]- a.offsets[1]+c.data.offset:j&&h.offsets[1]<k[0]?i=h.offsets[1]-a.offsets[1]+c.data.offset:h.offsets[1]+g.dimensions[1]>m[1]&&(i=h.offsets[1]-a.offsets[1]-(g.dimensions[1]-h.dimensions[1])-c.data.offset);null!=i&&(0>i?i=0:i>a.dimensions[1]-g.dimensions[1]&&(i=a.dimensions[1]-g.dimensions[1]),b.stop().animate({marginTop:i},c.data.animateSpeed))}else b.css("margin-top",0)},c.data.refreshSpeed)})}Simplr.Ui.Widget.oTrackableScrollingElement=function(b){return new a(b)};a.prototype.reset=function(){d(this.data.elementSelector).eq(0).css("margin-top", 0)};a.prototype.destroy=function(){this.reset();d(window).unbind(this.data._PRIVATE.evtString)}})();Simplr.Util={};Simplr.Util={mEmpty:function(a){return Simplr.Core.Util.mEmpty(a)},mEqual:function(a){return Simplr.Core.Util.mEqual(a)},mGetUrlParameter:function(a){return Simplr.Core.Util.mGetUrlParameter(a)},mHasLocalStorage:function(){return Simplr.Core.Util.mHasLocalStorage()},mTruncateString:function(a){a=d.extend({string:"",size:5,postfix:"",smart:!0},a);if(a.string.length>a.size){var b=a.size- a.postfix.length-1,c=b+1;if(a.smart)for(;" "!=a.string.charAt(b)&&0<b;)b--;return a.string.substring(0,0==b?c:b+1)+a.postfix}return a.string}};Simplr.Validation={};Simplr.Validation={mAddCodes:function(a){Simplr.Core.Validation.mAddCodes(a)},mGetCodes:function(){return Simplr.Core.Validation.mData().codes},mAddValidators:function(a){Simplr.Core.Validation.mAddValidators(a)},mGetValidators:function(){return Simplr.Core.Validation.mData().validators},mGetRuleResultsTemplate:function(){return Simplr.Core.Validation.mGetRuleResultsTemplate()}, mGetCodeMessage:function(a,b){return Simplr.Core.Validation.mGetCodeMessage(a,b)},mValidate:function(a){return Simplr.Core.Validation.mValidate(a)}};Simplr.View={};(function(){var a={Views:{}};Simplr.View={mAddViews:function(b){for(var c in b){var e=d.extend(!0,{},{html:function(){return""},callback:function(){}},b[c]);a.Views[c]=e}},mData:function(){return a},mRender:function(b){b=d.extend({name:"",data:"",selector:""},b);d(b.selector).html(a.Views[b.name].html(b.data));a.Views[b.name].callback(b.selector, b.data)}}})()})(jQuery);