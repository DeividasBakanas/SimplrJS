// Simplr 3.0.0
!function(){function e(e,t,r){$(function(){var n="#SimplrNotify_"+t
if(e){if(0==$("#SimplrNotify").size()){var i='<div id="SimplrNotify" style="position: fixed; z-index: 100000; top: 0; left: 0; width: 100%; box-shadow: 0 0 5px #000; text-transform: none; font-family: Arial; text-align: center; font-size: 16px; font-weight: normal; color: #000; background: #ccc none; line-height: 1.25; padding: 0; margin: 0; border: 0;"><!-- --></div>'
$("body").prepend(i)}if(0==$(n).size()){var a='<p id="'+n.replace("#","")+'" style="margin: 10px 0; padding: 0;">'+r+"</p>"
$("div#SimplrNotify").append(a)}}else $(n).remove(),$("#SimplrNotify").is(":empty")&&$("#SimplrNotify").remove()})}window.Simplr={},function(){function e(e){return e}function t(e){return e+"_data"}function r(e,t){return e+"|"+((new Date).getTime()+t)}Simplr.Cache={mExpire:function(r){return localStorage.removeItem(e(r)),localStorage.removeItem(t(r)),localStorage.getItem(t(r))},mGet:function(r){var r=$.extend({key:"",identifier:""},r)
if(""!=r.key){var n=localStorage.getItem(e(r.key))
if(null!=n){var i=n.split("|")
if(2==i.length&&i[0]==r.identifier)return(new Date).getTime()<=parseInt(i[1],10)?localStorage.getItem(t(r.key)):Simplr.Cache.mExpire(r.key)}}return null},mSet:function(n){var n=$.extend({key:"",identifier:"",data:"",freshness:6e5},n)
return""!=n.key?(localStorage.setItem(e(n.key),r(n.identifier,n.freshness)),localStorage.setItem(t(n.key),n.data),Simplr.Cache.mGet({key:n.key,identifier:n.identifier})):null}}}(),function(){var e={CRUD:{view:!0,"new":!0,update:!0,"delete":!0},Commands:{},Bases:{}}
Simplr.Controller={mAddBases:function(t){for(var r=$.isArray(t)?t:[t],n=0,i=r.length;i>n;n++)e.Bases[r[n]]=1},mAddCommands:function(t){for(var r in t){var n=$.extend({route:[],callback:function(){}},t[r]),i=n.route.join("_")
""!=i&&(e.Commands[i]=n.callback)}},mData:function(){return e},mExecute:function(t){var r=t.route.join("_")
$.isFunction(e.Commands[r])&&e.Commands[r](t)},mRoute:function(t){var r={route:[],url:t,base:"",resources:{},action:"",parameters:{}}
"#"==r.url.charAt(0)&&(r.url=r.url.substring(1)),"!"==r.url.charAt(0)&&(r.url=r.url.substring(1))
var n=r.url.split("?")
n[0]=decodeURI(n[0])
var i=n[0]
for(var a in e.Bases)if((n[0]=n[0].replace(a,""))!=i){r.base=a,r.route.push(a)
break}n[0]=n[0].split("/"),r.action=n[0][n[0].length-1],r.action=e.CRUD[r.action]?r.action:"view"
for(var o=!0,l="",s=0,u=n[0].length-1;u>s;s++)""!=n[0][s]&&(o?(l=n[0][s],r.route.push(l),r.resources[l]=""):r.resources[l]=n[0][s],o=!o)
if(n[1])for(var d=n[1].split("&"),m=0,c=d.length;c>m;m++){var p=d[m].split("=")
r.parameters[p[0]]=$.trim(decodeURIComponent(p[1]).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"))}return r.route.push(r.action),r},mRouteAndExecute:function(e){Simplr.Controller.mExecute(Simplr.Controller.mRoute(e))}},$(window).on("hashchange",{},function(){Simplr.Controller.mRouteAndExecute(window.location.hash)})}(),Simplr.Cookie={mExpire:function(e){return Simplr.Cookie.mSet($.extend({name:"",expireDays:-1},e))},mGet:function(e){var t=$.extend({name:""},e)
if(document.cookie.length>0&&!Simplr.Util.mEmpty(t.name)){var r=document.cookie.match("(^|;) ?"+t.name+"=([^;]*)(;|$)")
if(r)return decodeURIComponent(r[2])}return null},mSet:function(e){var t=$.extend({name:"",value:"",expireDays:null,path:"/",domain:null,secure:!1},e)
if(""!=t.name){var r=t.name+"="+encodeURIComponent(t.value)
if(!Simplr.Util.mEmpty(t.expireDays)){var n=new Date
n.setTime(n.getTime()+864e5*t.expireDays),r+="; expires="+n.toUTCString()}return r+=Simplr.Util.mEmpty(t.path)?"":"; path="+t.path,r+=Simplr.Util.mEmpty(t.domain)?"":"; domain="+t.domain,r+=t.secure?"; secure":"",document.cookie=r,Simplr.Cookie.mGet({name:t.name})}return null}},function(){var t=!1
Simplr.Console={mToggle:function(r){t=void 0!==window.console&&void 0!==window.console.group&&r,e(t,"Console","!-- Console Messaging is Active --!")},mMessage:function(e){if(t){var r=$.extend({group:"",message:"",data:""},e)
if($.isArray(r.message)){console.group(r.group)
for(var n=0,i=r.message.length;i>n;n++)Simplr.Console.mMessage(r.message[n])
console.groupEnd()}else console.group(r.message),console.log(r.data),console.groupEnd()}}}}(),function(){function e(e,t){var n="_simplr",i=r.Classes
$("."+i.FormError+","+"."+i.FieldError,e).filter("."+n).removeClass(i.FormError).removeClass(i.FieldError),$("."+i.TextInformation+","+"."+i.TextError,e).filter("."+n).remove()
for(var a in t.codes){for(var o=t.codes[a],l=[o.error,o.success],s="",u=0;2>u;u++)l[u].length>0&&(s+='<p class="'+(0==u?i.TextError:i.TextInformation)+" "+n+'">'+Simplr.Validation.mGetCodeMessage(l[u][0],t.data[a].label)+"</p>")
$("[name='"+a+"']:first",e).addClass(i.FieldError+" "+n).closest("."+i.FormEntry).addClass(i.FormError+" "+n).append(s)}}function t(e){var t={}
for(var n in e){for(var i=r.Labels[n]?r.Labels[n]:r.DefaultLabel,a={value:e[n],label:i,rules:[]},o=0,l=r.DefaultRules.length;l>o;o++)a.rules.push(r.DefaultRules[o])
$.isFunction(r.Rules[n])&&r.Rules[n](a.rules),t[n]=a}return t}var r={Classes:{FormEntry:"formEntry",FormError:"formError",FieldError:"errorField",TextError:"errorText",TextInformation:"informationText"},DefaultRules:["notempty"],DefaultLabel:"_LABEL_",Rules:{},Labels:{}}
Simplr.Form={mAddLabelAssociation:function(e){$.extend(r.Labels,e)},mAddValidationAssociation:function(e){$.extend(r.Rules,e)},mGetValues:function(e){var t={}
return $("input, select, textarea",e).each(function(){var e=$(this)
e.is("[type='button']")||e.is("[type='reset']")||e.is("[type='submit']")||e.is("[type='radio']")&&!e.is(":checked")||(t[$(this).attr("name")]=e.is("[type='checkbox']")?$(this).is(":checked")?"on"!=$(this).val()?$(this).val():!0:!1:$(this).val())}),t},mValidateValuesAndRender:function(r,n){var i=t(n),a=Simplr.Validation.mValidate(i)
return e(r,a),a.valid}}}(),function(){function e(e){return"object"==typeof e?Simplr.Layout.mAssembleLayout(e):e}function t(e,t){if(void 0!==t){$.extend(e,r.GlobalTokens)
for(var n in e)t=t.replace(RegExp("\\$\\["+n+"\\]","g"),escape(e[n]))}return unescape(t)}var r={Components:{},GlobalTokens:{}}
Simplr.Layout={mAddComponent:function(e,t){return r.Components[e]=$.trim(t.replace(/\n/g,"").replace(/\s{1,}/g," ")),!0},mGetComponent:function(e){if(void 0===r.Components[e]){var t=$("script#layout-"+e+"[type='text/x-simplr-layout-component']")
1==t.size()&&Simplr.Layout.mAddComponent(e,t.text())}return r.Components[e]},mAddGlobalToken:function(e,t){r.GlobalTokens[e]=t},mAssembleLayout:function(r){var n=""
if(r&&r.component&&r.tokens)for(var i=$.isArray(r.tokens)?r.tokens:[r.tokens],a=0,o=i.length;o>a;a++){var l={}
for(var s in i[a])l[s]=e(i[a][s])
n+=t(l,Simplr.Layout.mGetComponent(r.component))}return n},mData:function(){return r}}}(),function(){function e(){var e=[]
for(var t in r.Services)e.push(t)
return e}function t(t){var n={services:[],data:{envID:r.Env}}
$.extend(!0,n,t.options),Simplr.Util.mEmpty(n.services)&&(n.services=e())
for(var i={group:"simplr.trigger: "+r.Env+" environment",message:[]},a=0,o=n.services.length;o>a;a++){var l=n.services[a]
$.isFunction(r.Services[l][t.type])&&r.Services[l].data.environmentIDs[r.Env]&&i.message.push({message:"["+l+"] "+t.type+" triggered.",data:r.Services[l][t.type](n.data)})}i.message.length>0&&Simplr.Console.mMessage(i)}var r={Env:"_simplr",Services:{}}
Simplr.Trigger={mAddServices:function(e){for(var t in e)r.Services[t]=$.extend({data:{environmentIDs:{}},onLoad:function(){},onPage:function(){},onEvent:function(){},onTransaction:function(){}},e[t])},mData:function(){return r},mSetEnvironment:function(e){r.Env=e},mOnLoad:function(e){t({type:"onLoad",options:$.extend({},e)})},mOnPage:function(e){t({type:"onPage",options:$.extend({},e)})},mOnEvent:function(e){t({type:"onEvent",options:$.extend({},e)})},mOnTransaction:function(e){t({type:"onTransaction",options:$.extend({},e)})}}}(),function(){function e(t,r){if(typeof t==typeof r){if("object"!=typeof t)return t==r
if(!$.isArray(t)){for(var n in t)if(!e(t[n],r[n]))return!1
var i=0,a=0
for(var n in t)i++
for(var n in r)a++
return i==a}if(t.length==r.length){for(var o=0,l=t.length;l>o;o++)if(!e(t[o],r[o]))return!1
return!0}}return!1}Simplr.Util={mEmpty:function(e){var t=typeof e
return"undefined"!=t&&null!=e?"object"==t?$.isArray(e)?0==e.length:$.isEmptyObject(e):""==$.trim(e):!0},mEqual:function(t){if($.isArray(t)){for(var r=!0,n=0,i=t.length;i>n;n++)e(t[0],t[n])||(r=!1,n=i)
return r}return!0},mGetUrlParameter:function(e){var t=location.search
if(""!=t){t=t.substring(1).split("&")
for(var r={},n=0,i=t.length;i>n;n++){var a=t[n].split("=")
r[a[0]]=$.trim(decodeURIComponent(a[1]).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"))}if(Simplr.Util.mEmpty(e))return r
if(void 0!==r[e])return r[e]}return null},mTruncateString:function(e){var t=$.extend({string:"",size:5,postfix:"",smart:!0},e)
if(t.string.length>t.size){var r=t.size-t.postfix.length-1,n=r+1
if(t.smart)for(;" "!=t.string.charAt(r)&&r>0;)r--
return t.string.substring(0,0==r?n:r+1)+t.postfix}return t.string}}}(),function(){function e(e,t,r,n){n.codes[e].success=n.codes[e].success.concat(r.successCodes),n.codes[e].error=n.codes[e].error.concat(r.errorCodes),r.valid||(n.valid=!1)}function t(e,t){var r=t
for(var n in e)r=r.replace(RegExp("\\$\\["+n+"\\]","g"),escape(e[n]))
return unescape(r)}var r={codes:{eEmpty:"$[label] is empty.",eMissingValidator:"Missing Validator"},codeResultsTemplate:{success:[],error:[]},defaultCodeMessage:"$[label] is UNDEFINED",ruleResultsTemplate:{valid:!0,successCodes:[],errorCodes:[]},validators:{missingvalidator:function(){return $.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate(),{valid:!1,errorCodes:["eMissingValidator"]})},notempty:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate())
return void 0!==e&&null!=e&&("string"==typeof e?t.valid=!(""==$.trim(e)):$.isArray(e)?t.valid=!(0==e.length):"object"==typeof e&&(t.valid=!$.isEmptyObject(e))),t.valid||t.errorCodes.push("eEmpty"),t}},validationResultsTemplate:{data:"",valid:!0,codes:{}}}
Simplr.Validation={mAddCodes:function(e){$.extend(r.codes,e)},mGetCodes:function(){return r.codes},mAddValidators:function(e){$.extend(r.validators,e)},mGetValidators:function(){return r.validators},mGetRuleResultsTemplate:function(){return $.extend(!0,{},r.ruleResultsTemplate)},mGetCodeMessage:function(e,n){return void 0!=r.codes[e]?t({label:n},r.codes[e]):t({label:e},r.defaultCodeMessage)},mValidate:function(t){var n=$.extend(!0,{},r.validationResultsTemplate,{data:$.extend(!0,{},t)})
for(var i in n.data){var a=n.data[i]
n.codes[i]=$.extend(!0,{},r.codeResultsTemplate)
for(var o=0,l=a.rules.length;l>o;o++){var s=a.rules[o],u=$.extend(!0,{},r.ruleResultsTemplate)
u=r.validators[s]?r.validators[s](a.value):r.validators.missingvalidator(a.value),e(i,s,u,n)}0==n.codes[i].error.length&&0==n.codes[i].success.length&&delete n.codes[i]}return n}}}(),Simplr.Validation.mAddCodes({eMissingValidator:"Missing Validator",eAlphaNumeric:"$[label] is not alphanumeric.",eAmericanExpress:"$[label] is not a valid AMERICAN EXPRESS number.",eDinersClub:"$[label] is not a valid DINERS CLUB number.",eDiscover:"$[label] is not a valid DISCOVER number.",eEmail:"$[label] is not an email address.",eEqual:"$[label] does not match.",eMastercard:"$[label] is not a valid MASTERCARD number.",eEmpty:"$[label] is empty.",eNumber:"$[label] is not a number.",ePhoneNumber:"$[label] is not a valid Phone Number.",ePostalCode:"$[label] is not a Postal Code.",eVisa:"$[label] is not a valid VISA number."}),Simplr.Validation.mAddValidators({missingvalidator:function(){return $.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate(),{valid:!1,errorCodes:["eMissingValidator"]})},alphanumeric:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate(),{valid:/^\w*$/.test(e)})
return t.valid||t.errorCodes.push("eAlphaNumeric"),t},americanexpress:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate(),{valid:/^3(4|7)\d{2}-?\d{6}-?\d{5}$/.test(e)})
return t.valid||t.errorCodes.push("eAmericanExpress"),t},dinersclub:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate(),{valid:/^3[0,6,8]\d{12}$/.test(e)})
return t.valid||t.errorCodes.push("eDinersClub"),t},discover:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate(),{valid:/^6011-?\d{4}-?\d{4}-?\d{4}$/.test(e)})
return t.valid||t.errorCodes.push("eDiscover"),t},email:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate(),{valid:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(e)})
return t.valid||t.errorCodes.push("eEmail"),t},equal:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate())
if($.isArray(e))for(var r=0,n=e.length;n>r;r++)Simplr.Util.mEqual([e[0],e[r]])||(t.valid=!1,r=n)
return t.valid||t.errorCodes.push("eEqual"),t},mastercard:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate(),{valid:/^5[1-5]\d{2}-?\d{4}-?\d{4}-?\d{4}$/.test(e)})
return t.valid||t.errorCodes.push("eMastercard"),t},notempty:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate())
return void 0!==e&&null!=e&&("string"==typeof e?t.valid=!(""==$.trim(e)):$.isArray(e)?t.valid=!(0==e.length):"object"==typeof e&&(t.valid=!$.isEmptyObject(e))),t.valid||t.errorCodes.push("eEmpty"),t},number:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate(),{valid:!isNaN(parseFloat(e))&&isFinite(e)})
return t.valid||t.errorCodes.push("eNumber"),t},phonenumber:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate(),{valid:/^\d{10}$/.test(e)})
return t.valid||t.errorCodes.push("ePhoneNumber"),t},postalcode:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate(),{valid:/^\d{5}([\-]?\d{4})?$/.test(e)})
return t.valid||t.errorCodes.push("ePostalCode"),t},visa:function(e){var t=$.extend(!0,{},Simplr.Validation.mGetRuleResultsTemplate(),{valid:/^4\d{3}-?\d{4}-?\d{4}-?\d{4}$/.test(e)})
return t.valid||t.errorCodes.push("eVisa"),t}}),function(){var e={Views:{}}
Simplr.View={mAddViews:function(t){for(var r in t){var n=$.extend(!0,{},{html:function(){return""},callback:function(){}},t[r])
e.Views[r]=n}},mData:function(){return e},mRender:function(t){var r=$.extend({name:"",data:"",selector:""},t)
$(r.selector).html(e.Views[r.name].html(r.data)),e.Views[r.name].callback(r.selector,r.data)}}}()}()
